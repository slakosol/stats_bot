import pandas as pd
import matplotlib.pyplot as plt

pl = pd.read_csv("/home/slakosol/Materials/Code/Projects/Footy/stats_bot/data/pl_data.csv")
bl = pd.read_csv('/home/slakosol/Materials/Code/Projects/Footy/stats_bot/data/bl_data.csv')
serie_a = pd.read_csv('/home/slakosol/Materials/Code/Projects/Footy/stats_bot/data/seriea_data.csv')
laliga = pd.read_csv('/home/slakosol/Materials/Code/Projects/Footy/stats_bot/data/laliga_data.csv')

pl.sort_values(by=['total_goals'], inplace=True)
bl.sort_values(by=['total_goals'], inplace=True)
laliga.sort_values(by=['total_goals'], inplace=True)
serie_a.sort_values(by=['total_goals'], inplace=True)

fig, ax = plt.subplots(3, 4)
ax[0, 0].bar(pl['team'], pl['total_goals'])
ax[0, 0].axes.get_xaxis().set_visible(False)
ax[0, 0].title.set_text("Premier League")
ax[0, 0].set_ylabel("Num Goals")
ax[0, 1].bar(bl['team'], bl['total_goals'])
ax[0, 1].axes.get_xaxis().set_visible(False)
ax[0, 1].title.set_text("Bundesliga")
ax[0, 2].bar(laliga['team'], laliga['total_goals'])
ax[0, 2].axes.get_xaxis().set_visible(False)
ax[0, 2].title.set_text("La Liga")
ax[0, 3].bar(serie_a['team'], serie_a['total_goals'])
ax[0, 3].axes.get_xaxis().set_visible(False)
ax[0, 3].title.set_text("Serie A")

pl.sort_values(by=['total_passes'], inplace=True)
bl.sort_values(by=['total_passes'], inplace=True)
laliga.sort_values(by=['total_passes'], inplace=True)
serie_a.sort_values(by=['total_passes'], inplace=True)

ax[1, 0].bar(pl['team'], pl['total_passes'])
ax[1, 0].axes.get_xaxis().set_visible(False)
ax[1, 0].set_ylabel("Num Passes")
ax[1, 1].bar(bl['team'], bl['total_passes'])
ax[1, 1].axes.get_xaxis().set_visible(False)
ax[1, 2].bar(laliga['team'], laliga['total_passes'])
ax[1, 2].axes.get_xaxis().set_visible(False)
ax[1, 3].bar(serie_a['team'], serie_a['total_passes'])
ax[1, 3].axes.get_xaxis().set_visible(False)

ax[2, 0].scatter(pl['total_passes'], pl['total_goals'])
ax[2, 0].set_ylabel("Num Goals")
ax[2, 0].set_xlabel("Num Passes")
ax[2, 1].scatter(bl['total_passes'], bl['total_goals'])
ax[2, 1].set_ylabel("Num Goals")
ax[2, 1].set_xlabel("Num Passes")
ax[2, 2].scatter(laliga['total_passes'], laliga['total_goals'])
ax[2, 2].set_ylabel("Num Goals")
ax[2, 2].set_xlabel("Num Passes")
ax[2, 3].scatter(serie_a['total_passes'], serie_a['total_goals'])
ax[2, 3].set_ylabel("Num Goals")
ax[2, 3].set_xlabel("Num Passes")
plt.show()

print("Pearson R for Total Passes and Total Goals")
cols = ["total_passes", "total_goals"]
pl_corr = pl[cols].corr(method = "pearson")
bl_corr = bl[cols].corr(method = "pearson")
laliga_corr = laliga[cols].corr(method = "pearson")
serie_a_corr = serie_a[cols].corr(method = "pearson")
print(pl_corr)
print(bl_corr)
print(laliga_corr)
print(serie_a_corr)

print("Pearson R for Total Accurate Passes and Total Goals")
cols = ["total_acc_passes", "total_goals"]
pl_corr = pl[cols].corr(method = "pearson")
bl_corr = bl[cols].corr(method = "pearson")
laliga_corr = laliga[cols].corr(method = "pearson")
serie_a_corr = serie_a[cols].corr(method = "pearson")
print(pl_corr)
print(bl_corr)
print(laliga_corr)
print(serie_a_corr)

total_pl_passes_per_game = round(pl['total_passes'].sum() / 380, 2)
total_bl_passes_per_game = round(bl['total_passes'].sum() / 340, 2)
total_laliga_passes_per_game = round(laliga['total_passes'].sum() / 380, 2)
total_serie_a_passes_per_game = round(serie_a['total_passes'].sum() / 380, 2)

print("Total Passes per Game")
print("Premier League: " + str(total_pl_passes_per_game)) 
print("Bundesliga: " + str(total_bl_passes_per_game))
print("LaLiga: " + str(total_laliga_passes_per_game))
print("Serie A: " + str(total_serie_a_passes_per_game))

total_pl_goals_per_game = round(pl['total_goals'].sum() / 380, 2)
total_bl_goals_per_game = round(bl['total_goals'].sum() / 340, 2)
total_laliga_goals_per_game = round(laliga['total_goals'].sum() / 380, 2)
total_serie_a_goals_per_game = round(serie_a['total_goals'].sum() / 380, 2)

print("Total Goals per Game by League")
print("Premier League: " + str(total_pl_goals_per_game)) 
print("Bundesliga: " + str(total_bl_goals_per_game))
print("LaLiga: " + str(total_laliga_goals_per_game))
print("Serie A: " + str(total_serie_a_goals_per_game))

print("Average Accurate Pass Percentage by League")
avg_pl_acc_pass_perc = round(pl["acc_pass_perc"].mean(), 2)
avg_bl_acc_pass_perc = round(bl["acc_pass_perc"].mean(), 2)
avg_laliga_acc_pass_perc = round(laliga["acc_pass_perc"].mean(), 2)
avg_serie_a_acc_pass_perc = round(serie_a["acc_pass_perc"].mean(), 2)

print("Premier League: " + str(avg_pl_acc_pass_perc))
print("Bundesliga: " + str(avg_bl_acc_pass_perc))
print("LaLiga: " + str(avg_laliga_acc_pass_perc))
print("Serie A: " + str(avg_serie_a_acc_pass_perc))
